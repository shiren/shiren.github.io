<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.36e07a846507a6eb5914.css">.token.comment{font-size:13px}code[class*=language-],pre[class*=language-]{color:#f8f8f2;background:none;font-family:Fira Code,Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-all;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2e3440}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#636f88}.token.punctuation{color:#81a1c1}.namespace{opacity:.7}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#81a1c1}.token.number{color:#b48ead}.token.boolean{color:#81a1c1}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#a3be8c}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#81a1c1}.token.atrule,.token.attr-value,.token.class-name,.token.function{color:#88c0d0}.token.keyword{color:#81a1c1}.token.important,.token.regex{color:#ebcb8b}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}
/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}[hidden],template{display:none}body{font-size:1.2em;line-height:1.42857143;color:#404040}body,h1,h2,h3,h4,h5,h6{font-family:"\B098\B214\ACE0\B515",NanumGothic,NanumGothicWebFont,Malgun Gothic,"\B9D1\C740   \ACE0\B515",Dotum,"\B3CB\C6C0",Helvetica,Apple SD Gothic Neo,"sans-serif"}h1,h2,h3,h4,h5,h6{margin:30px 0 10px;font-weight:800}article a{text-decoration:none;color:#008aff}article a:hover{text-decoration:underline}p{line-height:1.5;margin:20px 0}li>p{margin:0}li{padding:2px 0}code.language-text{padding:2px 4px;color:#c7254e;background-color:#f9f2f4!important;border-radius:4px}div.gatsby-highlight{font-size:.9em}article em{font-style:normal;text-decoration:underline;text-underline-position:under}article img{display:block;width:90%;margin:0 auto}blockquote{padding:5px;color:#888;font-weight:500}blockquote p{line-height:1.6}</style><meta name="generator" content="Gatsby 2.24.65"/><style data-styled="" data-styled-version="5.2.0">.duvCfz{display:inline-block;vertical-align:middle;overflow:hidden;}/*!sc*/
data-styled.g1[id="StyledIconBase-ea9ulj-0"]{content:"duvCfz,"}/*!sc*/
.edzUAc{border:1px solid #eaeaea;border-width:0 1px 1px;background:#f5f5f5;text-align:center;}/*!sc*/
.edzUAc:hover{background:#eee;}/*!sc*/
data-styled.g2[id="top__SubMenu-ithwo9-0"]{content:"edzUAc,"}/*!sc*/
.bMktIb{float:right;width:25px;padding:0;margin-top:15px;margin-right:20px;background:none;border:none;}/*!sc*/
data-styled.g3[id="top__MenuButton-ithwo9-1"]{content:"bMktIb,"}/*!sc*/
.eFqqxc{float:right;padding:0;margin:0;}/*!sc*/
.eFqqxc ul{padding:0;}/*!sc*/
.eFqqxc > li{float:left;}/*!sc*/
.eFqqxc li{list-style:none;}/*!sc*/
.eFqqxc a,.eFqqxc button{display:block;padding:15px 15px;line-height:20px;background:none;border:none;text-transform:uppercase;font-size:12px;-webkit-letter-spacing:1px;-moz-letter-spacing:1px;-ms-letter-spacing:1px;letter-spacing:1px;color:#000;-webkit-text-decoration:none;text-decoration:none;font-family:'Open Sans','Helvetica Neue',Helvetica,Arial,sans-serif;cursor:pointer;}/*!sc*/
.eFqqxc > li > a,.eFqqxc > li > button{font-weight:500;}/*!sc*/
.eFqqxc > li > a:hover,.eFqqxc > li > button:hover{-webkit-text-decoration:underline;text-decoration:underline;}/*!sc*/
data-styled.g4[id="top__MenuList-ithwo9-2"]{content:"eFqqxc,"}/*!sc*/
.fTBtLg{display:none;position:absolute;}/*!sc*/
data-styled.g5[id="top__SubMenus-ithwo9-3"]{content:"fTBtLg,"}/*!sc*/
.jMtvLs:hover{background:#eee;}/*!sc*/
.jMtvLs:after{content:' ▼';}/*!sc*/
.jMtvLs ~ ul{display:none;}/*!sc*/
data-styled.g6[id="top__DropButton-ithwo9-4"]{content:"jMtvLs,"}/*!sc*/
.fnpIlM:hover .top__DropButton-ithwo9-4{background:#eee;}/*!sc*/
.fnpIlM:hover .top__SubMenus-ithwo9-3{display:block;}/*!sc*/
data-styled.g7[id="top__DropMenu-ithwo9-5"]{content:"fnpIlM,"}/*!sc*/
.qQGfI{float:left;padding:15px 15px;font-size:18px;line-height:20px;font-weight:800;color:#000;-webkit-text-decoration:none;text-decoration:none;font-family:'Open Sans','Helvetica Neue',Helvetica,Arial,sans-serif;}/*!sc*/
.qQGfI > img{width:30px;vertical-align:middle;border-radius:50%;margin:0 10px;}/*!sc*/
data-styled.g8[id="top__LogoButton-ithwo9-6"]{content:"qQGfI,"}/*!sc*/
.lbhjwZ{position:fixed;top:0;left:0;height:5px;background:#00bcbb;opacity:0.6;}/*!sc*/
data-styled.g9[id="top__Indicator-ithwo9-7"]{content:"lbhjwZ,"}/*!sc*/
.fmptlY{position:fixed;right:0;left:0;top:0;min-height:50px;padding:20px 0;margin-bottom:20px;border-bottom:1px solid #000;background:#fff;-webkit-transition:background 0.5s ease-in-out,padding 0.5s ease-in-out;transition:background 0.5s ease-in-out,padding 0.5s ease-in-out;z-index:1000;}/*!sc*/
.fmptlY > .top__MenuButton-ithwo9-1{display:none;}/*!sc*/
@media only screen and (max-width:768px){.fmptlY > .top__MenuButton-ithwo9-1{display:inline-block;}.fmptlY > .top__MenuList-ithwo9-2{display:none;float:none;margin-top:60px;}.fmptlY > .top__MenuList-ithwo9-2 > li{float:none;}.fmptlY > .top__MenuList-ithwo9-2 > li > a,.fmptlY > .top__MenuList-ithwo9-2 > li > button{-webkit-text-decoration:none;text-decoration:none;}.fmptlY .top__SubMenus-ithwo9-3{display:block;position:relative;background:none;}.fmptlY .top__DropButton-ithwo9-4{outline:0;cursor:default;}.fmptlY .top__DropButton-ithwo9-4:hover{background:none;-webkit-text-decoration:none;text-decoration:none;}.fmptlY .top__DropMenu-ithwo9-5{background:none;}.fmptlY .top__DropMenu-ithwo9-5:hover .top__DropButton-ithwo9-4{background:none;}.fmptlY .top__SubMenu-ithwo9-0{box-sizing:border-box;padding-left:30px;text-align:left;background:none;border:none;}.fmptlY .top__SubMenu-ithwo9-0:before{content:'-';vertical-align:middle;}.fmptlY .top__SubMenu-ithwo9-0 a,.fmptlY .top__SubMenu-ithwo9-0 button{display:inline-block;vertical-align:middle;-webkit-text-decoration:none;text-decoration:none;}}/*!sc*/
@media only screen and (max-width:460px){.fmptlY{position:relative;}}/*!sc*/
data-styled.g10[id="top__Wrapper-ithwo9-8"]{content:"fmptlY,"}/*!sc*/
.dKXtAy{margin-top:100px;padding:50px 0;border-top:1px #eaeaea solid;text-align:center;color:#fff;background:#000;}/*!sc*/
.dKXtAy > div{margin:0 auto;width:750px;text-align:center;font-size:14px;}/*!sc*/
data-styled.g11[id="footer__Wrapper-sc-1omp129-0"]{content:"dKXtAy,"}/*!sc*/
.cfgaXG{margin:0;padding:0;text-align:center;}/*!sc*/
.cfgaXG > li{display:inline-block;padding:0 10px;width:2em;height:2em;list-style:none;vertical-align:middle;}/*!sc*/
.cfgaXG a{color:#fff;}/*!sc*/
data-styled.g12[id="footer__FooterLinks-sc-1omp129-1"]{content:"cfgaXG,"}/*!sc*/
.hlzJWw{margin:120px auto 0;max-width:680px;padding:0 15px;box-sizing:border-box;}/*!sc*/
@media only screen and (max-width:768px){.hlzJWw{width:100%;}}/*!sc*/
data-styled.g13[id="layout__Container-dwdd9s-0"]{content:"hlzJWw,"}/*!sc*/
.lkGVVW{display:inline-block;margin-right:10px;border-bottom:1px solid #777;font-family:'Open Sans','Helvetica Neue',Helvetica,Arial,sans-serif;font-size:12px;font-weight:400;text-transform:uppercase;-webkit-text-decoration:none;text-decoration:none;color:#777;}/*!sc*/
data-styled.g22[id="category__Category-sc-156lajf-0"]{content:"lkGVVW,"}/*!sc*/
.hPYrMm{width:150px;position:-webkit-sticky;position:sticky;top:100px;margin-left:-180px;vertical-align:middle;}/*!sc*/
.hPYrMm > button{margin:0 0.25rem;}/*!sc*/
.hPYrMm > button:first-child{margin:0 0.25rem 0 0 !important;}/*!sc*/
@media only screen and (max-width:1080px){.hPYrMm{position:relative;float:right;width:200px;top:0;margin:-69px 0 0 0;}}/*!sc*/
@media only screen and (max-width:460px){.hPYrMm{position:relative;float:none;margin:-40px 0 0 0;}}/*!sc*/
data-styled.g33[id="share__Wrapper-sc-1h33god-0"]{content:"hPYrMm,"}/*!sc*/
.drbwQL{vertical-align:middle;}/*!sc*/
.drbwQL > svg{height:20px;width:20px;}/*!sc*/
data-styled.g34[id="share__Icon-sc-1h33god-1"]{content:"drbwQL,"}/*!sc*/
.kfPxZz{border-bottom:1px solid #000;color:#000;font-family:'Open Sans','Helvetica Neue',Helvetica,Arial,sans-serif;font-style:normal;font-weight:800;}/*!sc*/
@media only screen and (max-width:1080px){.kfPxZz{display:inline-block;border-bottom:none;vertical-align:middle;margin:0;}}/*!sc*/
data-styled.g35[id="share__Title-sc-1h33god-2"]{content:"kfPxZz,"}/*!sc*/
.bxZXPa{margin-top:60px;padding-top:10px;border-top:1px solid #000;}/*!sc*/
data-styled.g37[id="recomendPost__Wrapper-sc-3jwe1s-0"]{content:"bxZXPa,"}/*!sc*/
.dTTBOH{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;padding:20px 10px 0;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;}/*!sc*/
data-styled.g38[id="recomendPost__Container-sc-3jwe1s-1"]{content:"dTTBOH,"}/*!sc*/
.jiiBBj{padding:0;margin:10px 0 0 0;font-size:15px;color:#000;-webkit-transition:color 0.3s ease-in-out;transition:color 0.3s ease-in-out;}/*!sc*/
data-styled.g39[id="recomendPost__Title-sc-3jwe1s-2"]{content:"jiiBBj,"}/*!sc*/
.ivcrIP{-webkit-flex:0 0 49%;-ms-flex:0 0 49%;flex:0 0 49%;margin:0 0 25px;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;box-sizing:border-box;}/*!sc*/
.ivcrIP > div{padding:8px;border:1px solid #000;border-top:10px solid #000;-webkit-transition:background 0.3s ease-in-out;transition:background 0.3s ease-in-out;}/*!sc*/
.ivcrIP:hover > div{background:#000;}/*!sc*/
.ivcrIP:hover .recomendPost__Title-sc-3jwe1s-2{color:#fff;}/*!sc*/
data-styled.g40[id="recomendPost__Item-sc-3jwe1s-3"]{content:"ivcrIP,"}/*!sc*/
.jjtNTt{margin:10px 0 0 0;font-family:'Open Sans','Helvetica Neue',Helvetica,Arial,sans-serif;font-weight:300;font-size:14px;line-height:1.5;color:#b1b1b1;}/*!sc*/
data-styled.g41[id="recomendPost__Date-sc-3jwe1s-4"]{content:"jjtNTt,"}/*!sc*/
.ifREFF{display:block;-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
data-styled.g42[id="recomendPost__RecomendLink-sc-3jwe1s-5"]{content:"ifREFF,"}/*!sc*/
.fwhAwW{display:block;margin-top:40px;text-align:center;}/*!sc*/
.fwhAwW img{height:51px;width:217px;}/*!sc*/
data-styled.g43[id="post__BuyMeACoffee-jduihc-0"]{content:"fwhAwW,"}/*!sc*/
.eORrvq{position:relative;margin:130px 0 40px;}/*!sc*/
.eORrvq > h1{font-size:50px;}/*!sc*/
.eORrvq > p{margin:0 0 10px;font-size:18px;font-style:italic;color:#808080;}/*!sc*/
data-styled.g44[id="post__Headline-jduihc-1"]{content:"eORrvq,"}/*!sc*/
.jqxvuf{margin-top:-86px;}/*!sc*/
@media only screen and (max-width:1080px){.jqxvuf{margin-top:0;}}/*!sc*/
data-styled.g45[id="post__Article-jduihc-2"]{content:"jqxvuf,"}/*!sc*/
.bMNeLH{display:block;width:200px;margin:10px auto 0;color:#404040;-webkit-text-decoration:none;text-decoration:none;font-family:'Open Sans','Helvetica Neue',Helvetica,Arial,sans-serif;}/*!sc*/
data-styled.g46[id="post__AD-jduihc-3"]{content:"bMNeLH,"}/*!sc*/
</style><title data-react-helmet="true">웹 기술로 구현하는 Adaptive HTTP Streaming · shiren the creator</title><link data-react-helmet="true" rel="shortcut icon" type="image/x-icon" href="/favicon.ico"/><link data-react-helmet="true" rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800"/><meta data-react-helmet="true" name="description" content="웹 기술로 구현하는 Adaptive HTTP Streaming 한국은 물론 세계적으로 엄청난 양의 동영상 콘텐츠가 소비되고 있다. 플래시가 대세였던 웹 동영상 기술이 점차 표준 기술인 HTML5 비디오로 전환되었고 요즘은 대부분의 동영상 서비스는 HTML5를 기반으로 서비스되고 있다. 동영상 기술은 점차 고도화되어 네트워크 환경에 따른 최적의 동영상 품질을 스트리밍해 버퍼링없는 서비스를 제공하기 위해 여러 방법들이 모색되었고 그중 하나가 새로 프로토콜을 만드는 대신 기존의 HTTP를 이용해 구현하는 Adaptive HTTP Str…"/><meta data-react-helmet="true" name="image" content="http://image.toast.com/aaaadh/alpha/2017/techblog/atswithwebtechnology.png"/><meta data-react-helmet="true" name="author" content="Sungho Kim"/><meta data-react-helmet="true" property="og:url" content="https://blog.shiren.dev/2017-09-18-웹-기술로-구현하는-Adaptive-HTTP-Streaming/"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:title" content="웹 기술로 구현하는 Adaptive HTTP Streaming"/><meta data-react-helmet="true" property="og:description" content="웹 기술로 구현하는 Adaptive HTTP Streaming 한국은 물론 세계적으로 엄청난 양의 동영상 콘텐츠가 소비되고 있다. 플래시가 대세였던 웹 동영상 기술이 점차 표준 기술인 HTML5 비디오로 전환되었고 요즘은 대부분의 동영상 서비스는 HTML5를 기반으로 서비스되고 있다. 동영상 기술은 점차 고도화되어 네트워크 환경에 따른 최적의 동영상 품질을 스트리밍해 버퍼링없는 서비스를 제공하기 위해 여러 방법들이 모색되었고 그중 하나가 새로 프로토콜을 만드는 대신 기존의 HTTP를 이용해 구현하는 Adaptive HTTP Str…"/><meta data-react-helmet="true" property="og:image" content="http://image.toast.com/aaaadh/alpha/2017/techblog/atswithwebtechnology.png"/><meta data-react-helmet="true" property="image" content="http://image.toast.com/aaaadh/alpha/2017/techblog/atswithwebtechnology.png"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:creator" content="@shirenbeat"/><meta data-react-helmet="true" name="twitter:title" content="웹 기술로 구현하는 Adaptive HTTP Streaming"/><meta data-react-helmet="true" name="twitter:description" content="웹 기술로 구현하는 Adaptive HTTP Streaming 한국은 물론 세계적으로 엄청난 양의 동영상 콘텐츠가 소비되고 있다. 플래시가 대세였던 웹 동영상 기술이 점차 표준 기술인 HTML5 비디오로 전환되었고 요즘은 대부분의 동영상 서비스는 HTML5를 기반으로 서비스되고 있다. 동영상 기술은 점차 고도화되어 네트워크 환경에 따른 최적의 동영상 품질을 스트리밍해 버퍼링없는 서비스를 제공하기 위해 여러 방법들이 모색되었고 그중 하나가 새로 프로토콜을 만드는 대신 기존의 HTTP를 이용해 구현하는 Adaptive HTTP Str…"/><meta data-react-helmet="true" name="twitter:image" content="http://image.toast.com/aaaadh/alpha/2017/techblog/atswithwebtechnology.png"/><script data-react-helmet="true" type="application/ld+json">
            {
              "@context": "https://schema.org",
              "@type": "BlogPosting",
              "headline": "웹 기술로 구현하는 Adaptive HTTP Streaming",
              "image": [
                "http://image.toast.com/aaaadh/alpha/2017/techblog/atswithwebtechnology.png" 
              ],
              "datePublished": "2017-09-18T00:00:00.000Z",
              "test": 1
            }
          </script><link rel="alternate" type="application/rss+xml" title="shiren.dev RSS Feed" href="/feed.xml"/><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><script data-ad-client="ca-pub-4811193197471582" async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><link as="script" rel="preload" href="/webpack-runtime-a1ff71107fc67f26c43d.js"/><link as="script" rel="preload" href="/styles-55e82d6ff5158c00b714.js"/><link as="script" rel="preload" href="/framework-de237a875aa45b276a9d.js"/><link as="script" rel="preload" href="/app-405ee9187730cca34a4a.js"/><link as="script" rel="preload" href="/commons-8f7b6066959a66490891.js"/><link as="script" rel="preload" href="/d02ec7a3dda7d60b2b6f376de52e71913d9ba5e3-33b05cc05498f66ebadc.js"/><link as="script" rel="preload" href="/component---src-templates-post-tsx-9588f4661b7f11e95e51.js"/><link as="fetch" rel="preload" href="/page-data/2017-09-18-웹-기술로-구현하는-Adaptive-HTTP-Streaming/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/1529427419.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/1755485493.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2738229898.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/993531770.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div><nav class="top__Wrapper-ithwo9-8 fmptlY"><a href="https://blog.shiren.dev" class="top__LogoButton-ithwo9-6 qQGfI"><img alt="logo" src="/image/profile.jpg"/>shiren the creator</a><button class="top__MenuButton-ithwo9-1 bMktIb"><svg viewBox="0 0 448 512" aria-hidden="true" focusable="false" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="StyledIconBase-ea9ulj-0 duvCfz"><path fill="currentColor" d="M432 416H16a16 16 0 00-16 16v32a16 16 0 0016 16h416a16 16 0 0016-16v-32a16 16 0 00-16-16zm0-128H16a16 16 0 00-16 16v32a16 16 0 0016 16h416a16 16 0 0016-16v-32a16 16 0 00-16-16zm0-128H16a16 16 0 00-16 16v32a16 16 0 0016 16h416a16 16 0 0016-16v-32a16 16 0 00-16-16zm0-128H16A16 16 0 000 48v32a16 16 0 0016 16h416a16 16 0 0016-16V48a16 16 0 00-16-16z"></path></svg></button><ul class="top__MenuList-ithwo9-2 eFqqxc"><li><a href="/aboutme">ABOUT ME</a></li><li><a href="https://soundcloud.com/shiren" target="__blank">SOUNDCLOUD</a></li><li class="top__DropMenu-ithwo9-5 fnpIlM"><button class="top__DropButton-ithwo9-4 jMtvLs">OPENSOURCES</button><ul class="top__SubMenus-ithwo9-3 fTBtLg"><li class="top__SubMenu-ithwo9-0 edzUAc"><a href="https://ui.toast.com" target="__blank">TOAST UI</a></li><li class="top__SubMenu-ithwo9-0 edzUAc"><a href="https://github.com/shiren/upbo" target="__blank">UPBO Emacs + Karma integration</a></li><li class="top__SubMenu-ithwo9-0 edzUAc"><a href="https://github.com/shiren/karma-narrow-reporter" target="__blank">Karma narrow reporter</a></li></ul></li></ul><span style="width:0%" class="top__Indicator-ithwo9-7 lbhjwZ"></span></nav><div class="layout__Container-dwdd9s-0 hlzJWw"><div><header class="post__Headline-jduihc-1 eORrvq"><h1>웹 기술로 구현하는 Adaptive HTTP Streaming</h1><p>Posted on <!-- -->18 September, 2017<!-- --> </p></header><div class="share__Wrapper-sc-1h33god-0 hPYrMm"><h3 class="share__Title-sc-1h33god-2 kfPxZz">Share</h3><button aria-label="facebook" class="react-share__ShareButton button is-outlined is-rounded facebook" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><span class="share__Icon-sc-1h33god-1 drbwQL"><svg viewBox="0 0 320 512" aria-hidden="true" focusable="false" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="StyledIconBase-ea9ulj-0 duvCfz"><path fill="currentColor" d="M279.14 288l14.22-92.66h-88.91v-60.13c0-25.35 12.42-50.06 52.24-50.06h40.42V6.26S260.43 0 225.36 0c-73.22 0-121.08 44.38-121.08 124.72v70.62H22.89V288h81.39v224h100.17V288z"></path></svg></span></button><button aria-label="twitter" class="react-share__ShareButton button is-outlined is-rounded twitter" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><span class="share__Icon-sc-1h33god-1 drbwQL icon"><svg viewBox="0 0 512 512" aria-hidden="true" focusable="false" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="StyledIconBase-ea9ulj-0 duvCfz"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></span></button><button aria-label="linkedin" class="react-share__ShareButton button is-outlined is-rounded linkedin" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><span class="share__Icon-sc-1h33god-1 drbwQL icon"><svg viewBox="0 0 448 512" aria-hidden="true" focusable="false" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="StyledIconBase-ea9ulj-0 duvCfz"><path fill="currentColor" d="M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 01107.58 0c0 29.7-24.1 54.3-53.79 54.3zM447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3 94 0 111.28 61.9 111.28 142.3V448z"></path></svg></span></button><button aria-label="reddit" class="react-share__ShareButton button is-outlined is-rounded reddit" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><span class="share__Icon-sc-1h33god-1 drbwQL icon"><svg viewBox="0 0 512 512" aria-hidden="true" focusable="false" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="StyledIconBase-ea9ulj-0 duvCfz"><path fill="currentColor" d="M440.3 203.5c-15 0-28.2 6.2-37.9 15.9-35.7-24.7-83.8-40.6-137.1-42.3L293 52.3l88.2 19.8c0 21.6 17.6 39.2 39.2 39.2 22 0 39.7-18.1 39.7-39.7s-17.6-39.7-39.7-39.7c-15.4 0-28.7 9.3-35.3 22l-97.4-21.6c-4.9-1.3-9.7 2.2-11 7.1L246.3 177c-52.9 2.2-100.5 18.1-136.3 42.8-9.7-10.1-23.4-16.3-38.4-16.3-55.6 0-73.8 74.6-22.9 100.1-1.8 7.9-2.6 16.3-2.6 24.7 0 83.8 94.4 151.7 210.3 151.7 116.4 0 210.8-67.9 210.8-151.7 0-8.4-.9-17.2-3.1-25.1 49.9-25.6 31.5-99.7-23.8-99.7zM129.4 308.9c0-22 17.6-39.7 39.7-39.7 21.6 0 39.2 17.6 39.2 39.7 0 21.6-17.6 39.2-39.2 39.2-22 .1-39.7-17.6-39.7-39.2zm214.3 93.5c-36.4 36.4-139.1 36.4-175.5 0-4-3.5-4-9.7 0-13.7 3.5-3.5 9.7-3.5 13.2 0 27.8 28.5 120 29 149 0 3.5-3.5 9.7-3.5 13.2 0 4.1 4 4.1 10.2.1 13.7zm-.8-54.2c-21.6 0-39.2-17.6-39.2-39.2 0-22 17.6-39.7 39.2-39.7 22 0 39.7 17.6 39.7 39.7-.1 21.5-17.7 39.2-39.7 39.2z"></path></svg></span></button></div><article class="post__Article-jduihc-2 jqxvuf"><p><img src="http://image.toast.com/aaaadh/alpha/2017/techblog/atswithwebtechnology.png" alt="웹 기술로 구현하는 Adaptive HTTP Streaming"></p>
<p>한국은 물론 세계적으로 엄청난 양의 동영상 콘텐츠가 소비되고 있다. 플래시가 대세였던 웹 동영상 기술이 점차 표준 기술인 HTML5 비디오로 전환되었고 요즘은 대부분의 동영상 서비스는 HTML5를 기반으로 서비스되고 있다. 동영상 기술은 점차 고도화되어 네트워크 환경에 따른 최적의 동영상 품질을 스트리밍해 버퍼링없는 서비스를 제공하기 위해 여러 방법들이 모색되었고 그중 하나가 새로 프로토콜을 만드는 대신 기존의 HTTP를 이용해 구현하는 Adaptive HTTP Streaming이다.</p>
<h2>Adaptive HTTP Streaming이 무엇인가?</h2>
<p>Adaptive HTTP Streaming은 말 그대로 적응형 스트리밍이다. 사용자의 네트워크 상태에 적응(반응)해서 스트리밍을 하는 것이 이 기술의 주목표다. 비슷한 기술로는 RTSP/RTMP Streaming이 있지만, HTTP를 이용한 기술이 아니기 때문에 서비스를 유지하려면 추가적인 비용과 작업이 필요했다. 일반적으로 우리가 사용했던 스트리밍은 Progressive download(이하 PD)로 동영상 소스가 한번 선택되면 해당 콘텐츠를 끝까지 다운로드하면서 플레이를 해나가는 방식이다. HTML5 비디오에서도 기본적으로 PD의 형태로 사용할 수 있다.</p>
<p><img src="https://user-images.githubusercontent.com/389021/90834512-69003c00-e385-11ea-8fc1-057fff4b1f52.jpeg" alt="Progressive Download workflow"></p>
<p>이미지 출처: <a href="https://www.jwplayer.com/blog/what-is-video-streaming/">https://www.jwplayer.com/blog/what-is-video-streaming/</a></p>
<p>PD의 단점은 한가지 해상도의 동영상 소스가 선택되어 다운로드해나가는 방식이다 보니 네트워크 상황에 따라서 사용자는 버퍼링을 만날 수 있게 되고 이후 네트워크 상황이 좋아지지 않는다면 지속해서 버퍼링을 만나게 될 수밖에 없는 것이다. Adaptive Streaming은 바로 이 문제를 해결하기 위해 만들어졌다. 아이디어는 이렇다. 동영상 콘텐츠를 다양한 해상도로 인코딩해 저장해두고 데이터 단위도 동영상 콘텐츠 하나로 저장하는 게 아니라 잘게 쪼개 저장해둔다. 그리고 사용자가 동영상을 플레이할 때 네트워크 상황에 따라서 적절한 전략으로 콘텐츠의 소스를 선택해 최적의 스트리밍 서비스를 제공하는 것이다. 다양한 소스로 인코딩이 되어있으니 상황에 따라 선택할 수 있고 큰 파일 하나가 아닌 잘게 쪼개진 데이터들을 하나씩 다운로드하는 방식이라 다음 데이터를 다른 퀄리티로 쉽게 교체할 수 있게 된다. 예를 들면 현재 사용자의 네트워크 사정이 좋지 않다면 동영상의 480P 소스를 한 조각씩 스트리밍해주고 상황이 나아지면 다음 조각으로 그 이상의 해상도를 갖는 소스를 선택해 스트리밍하는 것이다.</p>
<p><img src="https://user-images.githubusercontent.com/389021/90834518-6b629600-e385-11ea-9212-f1212efc3508.jpeg" alt="Adaptive Streaming"></p>
<p>이미지 출처: <a href="https://www.jwplayer.com/blog/what-is-video-streaming/">https://www.jwplayer.com/blog/what-is-video-streaming/</a></p>
<p>넷플릭스나 유튜브 동영상을 시청할 때 처음에는 해상도가 좋지 않다가 점점 해상도가 좋아지는 것을 경험했던 적이 있을 것이다. 처음에는 사용자의 네트워크 상태를 판단할 수 없으니 낮은 해상도의 콘텐츠 조각을 내려주다가 네트워크의 품질이 식별되면 그에 따른 해상도로 내려주는 전략을 선택했을 것으로 짐작해볼 수 있다. Adaptive 하게 스트리밍을 하게 되면 서비스를 제공하는 서버의 트래픽을 관리할 수 있는 이점이 있는 것은 물론 사용자 입장에서도 네트워크 데이터 사용을 줄일 수 있는 장점이 있고 버퍼링 없는 동영상 시청이 가능하게 된다. 버퍼링을 감수하고라도 고해상도로 보고자 하는 유저들에게는 UI를 통한 선택권을 줄 수 있다.</p>
<h2>Adaptive Streaming의 흐름</h2>
<h3>서버 파트</h3>
<p>Adaptive streaming을 적용하기 위해서는 PD와는 다르게 동영상 스트리밍을 위해 미리 준비해야 할 것들이 더 있다. 하나면 되었던 동영상 파일을 지원 해상도 별로 인코딩을 해둬야 하고 한 개의 파일이 아니다 보니 각 조각난 파일들에 대한 정보를 클라이언트에 제공해줘야 한다. 전반적인 흐름은 아래와 같다.</p>
<ol>
<li>동영상을 업로드할때 파일을 작은 조각(세그먼트)으로 잘라낸다.</li>
<li>세그먼트들은 서비스에 필요에 따라 구분한 대역폭에 대응된 해상도로 인코딩한다. 여기서 해상도 별로 세그먼트의 개수가 늘어난다.</li>
<li>대응되는 해상도별 미디어 세그먼트의 정보등을 담은 파일(Manifest)을 클라이언트에 제공한다.</li>
</ol>
<p>동영상 파일을 작은 세그먼트로 잘라 낼때는 코덱별로 필요한 도구를 사용하게 되고 동영상의 조각난 세그먼트에 대한 정보를 제공해주는 문서 포맷에는 Apple-HLS와 MPEG-DASH이 있다.</p>
<h3>클라이언트 파트</h3>
<p>웹 클라이언트에서 Adaptive Streaming을 가능하게 하는 표준 기술로는 <a href="https://www.w3.org/TR/media-source/">Media Source Extensions(MSE)</a> 가 있고 이를 통해 스트리밍 데이터를 플레이어에 전달한다.</p>
<ol>
<li>클라이언트는 플레이할 동영상의 각 해상도별 세그먼트정보를 담은 Manifest 파일을 서버에게 요청한다.</li>
<li>Manifest 파일을 파싱해 필요한 정보들을 얻은 후 비디오에 대한 정보, 어떤 해상도의 퀄리티들을 사용할 수 있는지 그리고 어디서 해당 세그먼트들을 받을 수있는지(e.g. CDN URL)를 파악한다.</li>
<li>클라이언트는 사용자의 네트워크 대역폭을 측정하고 Manifest의 내용에 따라 가장 최적의 비디오 퀄리티를 선택한 뒤 필요한 세그먼트를 다운로드한다.(세그먼트를 다운로드하면서 다시 대역폭 측정)</li>
<li>다운로드한 세그먼트의 데이터를 MSE 버퍼에 제공한다.</li>
<li>MSE는 데이터를 디코딩하고 비디오객체에 제공해 플레이한다.(goto 3)</li>
</ol>
<h2>Apple-HLS, MPEG-DASH</h2>
<p>Adaptive HTTP Streaming을 제공하기 위한 Manifest 포맷으로 대표적인 것은 애플에서 독자적으로 만든 <a href="https://developer.apple.com/streaming/">HLS</a>와 Mpeg에서 표준화한 <a href="http://mpeg.chiariglione.org/standards/mpeg-dash">DASH</a>가 있다. HLS와 DASH는 동영상 스트리밍을 위한 콘텐츠 정보를 담고 있는 Manifest에 대한 스펙으로 일종의 프로토콜이라고 생각하면 된다. 장단이 있는데 HLS보다는 DASH가 더 확장성이 있고 열려있는 구조다 보니 DASH를 선호한다.</p>
<h3>Apple-HLS</h3>
<p>맥 제품군을 대상으로 개발된 포맷으로 맥용 사파리와 모바일 사파리에서는 네이티브로 지원하고 HTML5 비디오 소스로 HLS Manifest 파일을 직접 사용해 동영상을 스트리밍할 수 있다. 애플 벤더 위주의 포맷이다 보니 다양한 기종에 대한 서포트는 부족하지만 Microsoft Edge에서도 네이티브로 내장하게 됬고 안드로이드 기종의 브라우저들도 지원하고 있다. 네이티브로 HLS가 지원되다 보니 소스로 HLS Manifest를 사용하면 별다른 작업 없이 Adaptive 한 동영상 스트리밍이 동작한다. 하지만 이런 네이티브 구현은 서비스에서 전략적으로 스트리밍을 제어할 수 없다는 단점이 있다. 얼마전까지 미디어 컨테이너를 MP2TS만 사용하도록 스펙에서 제한되었는데 MP2TS 컨테이너는 패킷 헤더로 인해 세그먼트의 크기가 증가할수록 헤더에 의한 오버헤드가 커지는 문제가 있었고 코덱의 브라우저 호환성에도 문제가 있었다. 특히 크롬에서 MP2TS를 지원하지 않아 크롬에서 정상적으로 플레이하려면 디먹싱(demux)을 통해 mp4로 변환해야 했다. 2016년부터는 HLS에서도 MP4 컨테이너를 사용할 수 있게 되었다. HLS는 Manifest로 mp3 음원 목록을 만들때 사용하던 M3U8 플레이리스트를 이용한다. m3u8이란 확장에 제한이 있는 형식으로 컨텐츠의 종류를 서술하다 보니 메인 m3u8과 서브 m3u8구조로 나눠 컨텐츠의 종류와 세그먼트 정보를 표현한다.</p>
<ul>
<li>Apple에서 개발</li>
<li>사파리나 특정 브라우저에서는 HTML5 Video의 미디어 소스로 바로 HLS스트리밍을 사용할 수 있다.</li>
<li>모바일 사파리에서는 MSE를 지원하지 않아 HLS외엔 사용이 불가능</li>
<li>미디어 컨테이너 포맷: mp2ts, mp4(2016)</li>
<li>Manifest로 m3u8을 사용</li>
</ul>
<div class="gatsby-highlight" data-language="m3u8"><pre class="language-m3u8"><code class="language-m3u8">    #EXTM3U
    #EXT-X-STREAM-INF:PROGRAM-ID=1, BANDWIDTH=200000, RESOLUTION=720x480
    http://ALPHA.mycompany.com/lo/prog_index.m3u8
    #EXT-X-STREAM-INF:PROGRAM-ID=1, BANDWIDTH=200000, RESOLUTION=720x480
    http://BETA.mycompany.com/lo/prog_index.m3u8
    
    #EXT-X-STREAM-INF:PROGRAM-ID=1, BANDWIDTH=500000, RESOLUTION=1920x1080
    http://ALPHA.mycompany.com/md/prog_index.m3u8
    #EXT-X-STREAM-INF:PROGRAM-ID=1, BANDWIDTH=500000, RESOLUTION=1920x1080
    http://BETA.mycompany.com/md/prog_index.m3u8
    ....중략....</code></pre></div>
<h3>Mpeg-DASH</h3>
<p>MPEG과 ISO에 의해 비준된 표준 포맷이다. 특정 벤더에서 독자적으로 개발한 스펙이 아닌 말 그대로 표준이다. 벤더기반이 아니다 보니 네이티브에서 지원하는 브라우저는 아직 없어 특별한 작업 없이 HTML5 비디오에 바로 소스로 사용할 수 있는 브라우저는 없다. 이후 설명할 MSE를 통해 서비스가 원하는 대로 Adaptive 한 스트리밍을 직접 구현해 줘야 한다. 주요 특징은 미디어 포맷에 제한이 없으며 Manifest인 Media Presentation Description(MPD)은 XML을 기반으로 만들어져 메인 콘텐츠 외에 광고 등을 삽입할 수 있을 정도로 표현력이 풍성하다. 그 풍부한 표현력 덕에 m3u8와 달리 한 개의 Manifest 파일로 모든 정보를 담을 수 있다.</p>
<ul>
<li>MPEG, ISO 비준 표준</li>
<li>Dash는 MSE를 이용해 브라우저의 네이티브 재생기능을 이용할 수 있다.</li>
<li>Dash는 미디어 컨테이너 포맷에 제한이 없다.</li>
<li>광고의 삽입이 수월하고 자연스럽다(Period 구성)</li>
<li>Manifest가 XML로 구성되어 있어 풍성한 표현이 가능해 다양한 정보를 한 개의 MPD로 제공한다. (DRM 정보까지)</li>
</ul>
<div class="gatsby-highlight" data-language="xml"><pre class="language-xml"><code class="language-xml">    <span class="token prolog">&lt;?xml version="1.0"?></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>MPD</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>urn:mpeg:dash:schema:mpd:2011<span class="token punctuation">"</span></span> <span class="token attr-name">profiles</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>urn:mpeg:dash:profile:full:2011<span class="token punctuation">"</span></span> <span class="token attr-name">minBufferTime</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>PT1.5S<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!-- Ad --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Period</span> <span class="token attr-name">duration</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>PT30S<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>BaseURL</span><span class="token punctuation">></span></span>ad/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>BaseURL</span><span class="token punctuation">></span></span>
            <span class="token comment">&lt;!-- Everything in one Adaptation Set --></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>AdaptationSet</span> <span class="token attr-name">mimeType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>video/mp2t<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                <span class="token comment">&lt;!-- 720p Representation at 3.2 Mbps --></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Representation</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>720p<span class="token punctuation">"</span></span> <span class="token attr-name">bandwidth</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>3200000<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1280<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>720<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                    <span class="token comment">&lt;!-- Just use one segment, since the ad is only 30 seconds long --></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>BaseURL</span><span class="token punctuation">></span></span>720p.ts<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>BaseURL</span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SegmentBase</span><span class="token punctuation">></span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RepresentationIndex</span> <span class="token attr-name">sourceURL</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>720p.sidx<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SegmentBase</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Representation</span><span class="token punctuation">></span></span>
                <span class="token comment">&lt;!-- 1080p Representation at 6.8 Mbps --></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Representation</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1080p<span class="token punctuation">"</span></span> <span class="token attr-name">bandwidth</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>6800000<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1920<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1080<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>BaseURL</span><span class="token punctuation">></span></span>1080p.ts<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>BaseURL</span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SegmentBase</span><span class="token punctuation">></span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RepresentationIndex</span> <span class="token attr-name">sourceURL</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1080p.sidx<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SegmentBase</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Representation</span><span class="token punctuation">></span></span>
    ....중략....</code></pre></div>
<h2>MSE(Media Source Extensions)</h2>
<p>HLS의 경우 맥용 사파리나 모바일용 사파리에서 바로 미디어 소스로 적용할 수 있지만 DASH일 경우에는 대부분 MSE를 이용해 직접 미디어 소스를 확장한다. 사실 DASH나 HLS는 스트리밍할 미디어 데이터의 정보를 동영상 플레이어에게 전달하는 목적으로 만들어졌기 때문에 실질적으로 플레이에 관여하는 부분은 아니다. MSE는 DASH 혹은 HLS Manifest를 통해 필요한 미디어 정보들을 얻은 다음 실질적으로 미디어 조각들을 웹상에서 HTML5 비디오를 통해 플레이할때 사용된다. (물론 사파리에서는 HLS Manifest를 그대로 소스로 사용할 수 있다) MSE는 HTML5의 비디오로 동영상을 재생할 때 소스를 제공할 목적으로 사용하던 <code class="language-text">source</code> 태그 대신 HTMLMediaElement을 이용해 개발자가 직접 새로운 미디어 소스를 정의할 수 있게 해주는 인터페이스이다. 개발자가 플레이될 동영상의 데이터를 HTTP를 통해 받은 후 SourceBuffer 객체를 이용해 직접 HTMLMediaElement에 미디어 버퍼 청크를 제공하는 방법으로 개발한다. 동영상을 플레이할 때 HTML5 비디오가 필요한 데이터들을 개발자가 관여해서 제공할 수 있게 된 것이다. MSE 구현 코드를 보기 전에 간단하게 주요 개념을 몇 가지를 살펴보자.</p>
<h3>세그먼트</h3>
<p>세그먼트는 인코딩된 동영상 데이터의 작은 조각이다. 이 조각에 대한 정보는 DASH나 HLS를 통해 얻어오고 한 조각 한 조각 모와서 유저가 동영상을 볼 수 있도록 플레이어에 전달하는 것이다. 세그먼트는 두 가지 종류의 세그먼트가 있다. <strong>Initialization Segment</strong> (초기화 세그먼트) 와 <strong>Media Segment</strong> (미디어 세그먼트) 다. <strong>초기화 세그먼트</strong> 는 실제 동영상 정보를 담고 있는 미디어 세그먼트의 시퀀스를 디코딩하는데 필요한 정보를 담고 있는데 코덱 초기화 데이터, 트랙 ID, 타임스탬프 오프셋 등의 정보를 포함한다. <strong>미디어 세그먼트</strong> 는 패킷화된 그리고 자신이 플레이되어야 할 미디어 타임라인상의 타임스탬프 정보가 포함된 실제 동영상 데이터다. 미디어 세그먼트는 초기화 세그먼트의 정보를 토대로 자신의 위치를 알기 때문에 미디어 세그먼트를 순차적으로 플레이어에 제공하지 않아도 플레이되어야 할 위치에서 플레이 되게 된다. 반대로 초기화 세그먼트가 없다면 미디어 세그먼트의 데이터를 아무리 플레이어에 제공해도 정상적으로 플레이가 되지 않는다.</p>
<h3>MediaSource 객체, SourceBuffer 객체</h3>
<p>MediaSource는 HTMLMediaElement의 미디어 데이터 소스를 나타낸다. 동영상 플레이어에서 플레이되고 있는 한 종류의 미디어라고 이해하면 된다. SourceBuffer를 이용해 MediaSource에 미디어 세그먼트를 전달해주고 HTMLMediaElement(Video)는 플레이하면서 필요한 데이터를 MediaSource로 부터꺼내와 사용한다.
구조적으로 HTMLMediaELement가 MediaSource를 사용하고 MediaSource는 SourceBuffer를 소유하고 사용한다.</p>
<p><img src="https://www.w3.org/TR/2015/CR-media-source-20150331/pipeline_model.png" alt="미디어 소스 파이프라인">
이미지출처: <a href="https://www.w3.org/TR/media-source/">https://www.w3.org/TR/media-source/</a>)</p>
<h2>HTML5 Video와 MSE 연동하기</h2>
<p>구글링을 해보면 MSE에 대한 자료가 몇 가지가 있는데 나온 지 얼마 되지 않은 스펙이다 보니 MSE를 제대로 이해하기 위해서는 <a href="https://www.w3.org/TR/media-source/">W3C스펙문서</a>를 보는것이 가장 확실한 방법인 것 같다. 다행히 스펙 내용이 적은 편이라 읽기 수월하다. MSE의 인터페이스 사용 방법만을 알고자 할 때는 알고리즘 부분은 생략해도 된다. 스펙 문서의 전체적인 내용은 맨 하단의 예제코드에서 전반적으로 드러나 있다. 이 예제 코드를 옮겨와 한줄 한줄 주석을 달아 설명하고자 하는데 그 전에 몇 가지 중요한 부분만 먼저 살펴본다.</p>
<p>동영상 플레이어 즉 Video(HTMLMediaElement) 객체에 스트리밍 소스를 제공하는 기술인 MSE의 핵심은 MediaSource 다. MediaSource객체를 만들고 Video 객체 연결하는 것이 첫 번째 작업이 된다.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">    <span class="token keyword">var</span> mediaSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MediaSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    video<span class="token punctuation">.</span>src <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>mediaSource<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>Video와 MediaSource는 Object URL을 통해 연결하게 되는데 window.URL.createObjectURL함수를 사용해 MediaSource 객체의 Object URL을 만든다.
그리고 Video와 연결이 되면 MediaSource 객체는 스트리밍 데이터를 받을 준비가 되었음을 알리는 이벤트 sourceopen을 발생하고 이 이벤트를 시작으로 추가적인 작업을 하게 된다.
MediaSource가 정상적으로 준비가 되면 SourceBuffer 객체를 만든다. 이후 반복적으로 세그먼트를 가져와 SourceBuffer를 통해 스트리밍할 데이터를 Video에 전달한다.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">    <span class="token keyword">var</span> sourceBuffer <span class="token operator">=</span> mediaSource<span class="token punctuation">.</span><span class="token function">addSourceBuffer</span><span class="token punctuation">(</span><span class="token string">'video/webm; codecs="vorbis,vp8"'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>addSourceBuffer는 코덱 정보를 인자로 받아 해당 코덱의 데이터를 디코딩할 수 있는 SourceBuffer객체를 리턴한다.
이후에 서버에서 미디어 세그먼트 정보를 받아와 소스 버퍼에 제공하는 작업은 SourceBuffer객체의 appendBuffer 메서드를 사용한다. Ajax로 미디어 세그먼트 정보를 받아올 때의 response type은 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer">ArrayBuffer</a>을 사용한다.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">    <span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">;</span>
    xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'get'</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">;</span>
    xhr<span class="token punctuation">.</span>responseType <span class="token operator">=</span> <span class="token string">'arraybuffer'</span><span class="token punctuation">;</span>
    xhr<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      sourceBuffer<span class="token punctuation">.</span><span class="token function">appendBuffer</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>appendBuffer를 사용한 이후에는 MediaSource 내부에서 데이터를 디코딩하는 작업을 수행되며 이때는 새로운 버퍼 데이터가 제공되면 안 된다. 이후 비디오 객체의 progress이벤트등을 이용해 지속해서 버퍼를 받아와 제공하는 작업을 해야 한다.
간략하게 주요 인터페이스를 위주로 흐름을 살펴봤다. 이제 w3c스펙문서 하단에 있는 예제 코드를 주석과 함께 살펴보자.</p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>video</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>v<span class="token punctuation">"</span></span> <span class="token attr-name">autoplay</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>video</span><span class="token punctuation">></span></span>
    
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
      <span class="token keyword">var</span> video <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'v'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
      <span class="token comment">// 새로운 MediaSource 만든다.</span>
      <span class="token keyword">var</span> mediaSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MediaSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
      <span class="token comment">// MediaSource가 Video에 연결되어 스트리밍 데이터를 받을 준비가 되면 sourceopen 이벤트가 발생한다.</span>
      mediaSource<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'sourceopen'</span><span class="token punctuation">,</span> <span class="token function">onSourceOpen</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> video<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
      <span class="token comment">// 비디오 객체에 우리의 MediaSource를 연결해준다.</span>
      video<span class="token punctuation">.</span>src <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>mediaSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
      <span class="token comment">// 미디어 소스가 오픈되면 실행되는 핸들러다.</span>
      <span class="token keyword">function</span> <span class="token function">onSourceOpen</span><span class="token punctuation">(</span><span class="token parameter">videoTag<span class="token punctuation">,</span> e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> mediaSource <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">;</span>
    
        <span class="token comment">// 불필요한 상황에서 sourceopen 이벤트가 발생될때를 걸러낸다. sourceBuffer가 있어야한다.</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>mediaSource<span class="token punctuation">.</span>sourceBuffers<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
    
        <span class="token comment">// 미디어 소스에 addSourceBuffer 메서드를 이용해 sourceBuffer를 만든다. 인자는 코덱정보다.</span>
        <span class="token comment">// 예제코드에서 sourceBuffer는 webm 코덱으로 인코딩된 데이터를 받을 수 있게 된다.</span>
        <span class="token keyword">var</span> sourceBuffer <span class="token operator">=</span> mediaSource<span class="token punctuation">.</span><span class="token function">addSourceBuffer</span><span class="token punctuation">(</span><span class="token string">'video/webm; codecs="vorbis,vp8"'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
        <span class="token comment">// 비디오 객체의 필요에 따라 버퍼 제공해야 하니 핸들러를 걸어준다.</span>
        videoTag<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'seeking'</span><span class="token punctuation">,</span> <span class="token function">onSeeking</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>videoTag<span class="token punctuation">,</span> mediaSource<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        videoTag<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'progress'</span><span class="token punctuation">,</span> <span class="token function">onProgress</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>videoTag<span class="token punctuation">,</span> mediaSource<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
        <span class="token comment">// 어플리케이션 코드로 초기화 세그먼트를 얻어온다. 물론 이 과정은 비동기 작업이 되겠지만...</span>
        <span class="token comment">// 초기화혹은 미디어 세그먼트는 ajax 요청시 응답 타입을 "arrayBuffer"로 받아와야 한다.</span>
        <span class="token keyword">var</span> initSegment <span class="token operator">=</span> <span class="token function">GetInitializationSegment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
        <span class="token keyword">if</span> <span class="token punctuation">(</span>initSegment <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// 초기화 세그먼트를 못 가져오면 어차피 플레이가 되지 않는다.</span>
          <span class="token comment">// mediaSource.endOfstream 메서드로 스트림을 종료한다. 이 메서드는 정상적으로 스트림이 종료되었을때도 호출되고</span>
          <span class="token comment">// 오류로인한 종료일때도 원인을 인자로 넘겨 종료한다. "network" 혹은 "decode"</span>
          mediaSource<span class="token punctuation">.</span><span class="token function">endOfStream</span><span class="token punctuation">(</span><span class="token string">"network"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    
        <span class="token comment">// 초기화 세그먼트를 sourceBuffer에 제공한다.</span>
        <span class="token comment">// firstAppendHandler 초기화 세그먼트가 정상적으로 sourceBuffer에 들어가고 나면 한번 실행되고 이벤트 핸들러에서 제거된다.</span>
        <span class="token comment">// 초기화 세그먼트가 들어가고 난 뒤 미디어 세그먼트로 전환하려고 잠깐 사용되는 함수다.</span>
        <span class="token keyword">var</span> <span class="token function-variable function">firstAppendHandler</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">var</span> sourceBuffer <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">;</span>
          sourceBuffer<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'updateend'</span><span class="token punctuation">,</span> firstAppendHandler<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
          <span class="token comment">// 아래의 함수를 통해 본격적으로 미디어 버퍼를 sourceBuffer에 제공하는 단계로 넘어간다.</span>
          <span class="token function">appendNextMediaSegment</span><span class="token punctuation">(</span>mediaSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    
        <span class="token comment">// sourceBuffer는 미디어 데이터를 받으면 해당 데이터를 디코딩하는 작업을 하게 되는데</span>
        <span class="token comment">// update는 작업이 성공적으로 종료되었을 때 updateend는 성공, 실패 상관없이 종료되었을 때 발생한다.</span>
        <span class="token comment">// 여기서는 초기화 세그먼트를 제공하고 미디어 세그먼트를 제공하기위해 잠깐 사용된다.</span>
        sourceBuffer<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'updateend'</span><span class="token punctuation">,</span> firstAppendHandler<span class="token punctuation">)</span><span class="token punctuation">;</span>
        sourceBuffer<span class="token punctuation">.</span><span class="token function">appendBuffer</span><span class="token punctuation">(</span>initSegment<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    
    
      <span class="token comment">// 초기화 세그먼트가 제공된 이후 미디어 세그먼트를 제공하는 함수</span>
      <span class="token comment">// 첫 실행 이후에는 비디오 객체의 progress 이벤트에 의해 실행된다.</span>
      <span class="token keyword">function</span> <span class="token function">appendNextMediaSegment</span><span class="token punctuation">(</span><span class="token parameter">mediaSource</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// MediaSource.readyState는 총 세가지 스테이트를 가질 수 있는데 "open", "closed", "ended"다</span>
        <span class="token comment">// "open" 이면 현재 미디어 데이터를 처리중에 있고 "ended"는 대기 상태와 동일하다.</span>
        <span class="token comment">// "closed"인 경우는 더이상 미디어 스트림을 받을 수 없다.</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>mediaSource<span class="token punctuation">.</span>readyState <span class="token operator">==</span> <span class="token string">"closed"</span><span class="token punctuation">)</span>
          <span class="token keyword">return</span><span class="token punctuation">;</span>
    
        <span class="token comment">// 어플리케이션 코드로 더이상 제공할 미디어 세그먼트가 없다면 endOfStream으로 스트리밍을 종료한다.</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">HaveMoreMediaSegments</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          mediaSource<span class="token punctuation">.</span><span class="token function">endOfStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    
        <span class="token comment">// 동영상 버퍼를 제공하는 과정은 데이터를 디코딩하는 과정을 거쳐야 하므로 시간과 CPU 비용이 든다.</span>
        <span class="token comment">// 항상 sourceBuffer가 updating 상태인지를 체크하고 새로운 버퍼를 제공해야 한다.</span>
        <span class="token comment">// updating이 true인 경우 이전 미디어 데이터를 처리하고 있는 중이다.</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>mediaSource<span class="token punctuation">.</span>sourceBuffers<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>updating<span class="token punctuation">)</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
    
        <span class="token comment">// 어플리케이션 코드다 다음 미디어 세그먼트를 받아온다.</span>
        <span class="token keyword">var</span> mediaSegment <span class="token operator">=</span> <span class="token function">GetNextMediaSegment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>mediaSegment<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// 없으면 에러</span>
          mediaSource<span class="token punctuation">.</span><span class="token function">endOfStream</span><span class="token punctuation">(</span><span class="token string">"network"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    
        <span class="token comment">// 미디어 데이터를 sourceBuffer에 제공한다.</span>
        <span class="token comment">// MediaSource.readyState가 "ended"인 경우 다시 "open"되면서</span>
        <span class="token comment">// sourceopen이벤트에 걸려있는 onSourceOpen핸들러가 다시 실행될 수 있으니 대처해야 한다.</span>
        mediaSource<span class="token punctuation">.</span>sourceBuffers<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">appendBuffer</span><span class="token punctuation">(</span>mediaSegment<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    
      <span class="token comment">// seeking 이벤트 핸들러로 시킹된 해당 위치의 미디어 데이터를 제공하는 작업을 수행한다.</span>
      <span class="token keyword">function</span> <span class="token function">onSeeking</span><span class="token punctuation">(</span><span class="token parameter">mediaSource<span class="token punctuation">,</span> e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> video <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">;</span>
    
        <span class="token comment">// sourceBuffer에서 처리되고 있는 버퍼가 있다면 취소한다.</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>mediaSource<span class="token punctuation">.</span>readyState <span class="token operator">==</span> <span class="token string">"open"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          mediaSource<span class="token punctuation">.</span>sourceBuffers<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">abort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    
        <span class="token comment">// 어플리케이션 코드로 비디오 객체에서 현재 동영상이 플레이되는 위치를 읽어 해당 미디어 세그먼트를 준비하게 한다.</span>
        <span class="token function">SeekToMediaSegmentAt</span><span class="token punctuation">(</span>video<span class="token punctuation">.</span>currentTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
        <span class="token comment">// MediaSource에 변경된 버퍼를 제공한다.</span>
        <span class="token function">appendNextMediaSegment</span><span class="token punctuation">(</span>mediaSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    
      <span class="token comment">// progress 이벤트 핸들러로 플레이될 세그먼트의 데이터를 준비해 sourceBuffer에 제공한다.</span>
      <span class="token keyword">function</span> <span class="token function">onProgress</span><span class="token punctuation">(</span><span class="token parameter">mediaSource<span class="token punctuation">,</span> e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">appendNextMediaSegment</span><span class="token punctuation">(</span>mediaSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre></div>
<p>예제코드의 전반적인 흐름을 짧게 요약하면 아래와 같다.</p>
<ol>
<li>MediaSource의 새 인스턴스를 만들고 비디오 객체와 Object URL로 연결한다.</li>
<li>MediaSource가 준비되면 sourceOpen 이벤트가 발생한다.</li>
<li>MediaSource에서 사용하게될 코덱 데이터를 디코딩할 수 있는 sourceBuffer를 준비한다.</li>
<li>SourceBuffer에 초기화 세그먼트를 제공하고 디코딩이 완료되면 미디어 세그먼트를 제공한다.</li>
<li>이후 progress와 seeking 이벤트 따라 비디오 객체의 타임라인 위치에 해당하는 미디어 세그먼트를 제공한다.</li>
</ol>
<p>예제 코드는 순수하게 MSE를 사용하는 방법에 대한 예제를 제공하고 있는데 실제 서비스에서는 DASH나 HLS형태의 Manifest를 다운로드하고 파싱해 미디어 정보를 얻어오는 부분이 포함되어야 한다. 그리고 유저의 Bandwidth를 체크해서 적절한 퀄리티를 선택하는 코드도 들어가야할 것이다. 사실 대역폭을 체크해서 최적의 해상도를 선정하는 부분은 생각보다 쉽지 않다. 클라이언트에서 대역폭을 측정해보면 순간순간의 편차가 매우 크기 때문에 (특히 모바일) 이 대역폭 값들을 어떻게 가공해서 사용할지에 대한 방법도 충분한 고려가 필요하다. 보통 <a href="http://www.itl.nist.gov/div898/handbook/pmc/section3/pmc324.htm">EWMA Control Charts</a> 를 이용해 모수를 추정한다.</p>
<h2>마치며</h2>
<p>웹 브라우저상에서 Adaptive HTTP Streaming을 구현하는 전반적인 기술들을 훑어봤다. 그리고 이제 MSE는 <a href="https://www.w3.org/TR/encrypted-media/">Encrypted Media Extensions</a> 와 연계하여 DRM까지 커버할 수 있게 되었다. 과거에는 플래시나 실버라이트가 아니면 불가능 했던 일들이 점점 표준 웹기술만으로 가능해지고 있고 이런 웹기술이 나오는 속도는 점점 가속화되고 있다. 앞으로 또 어떤 기술이 나와서 무엇을 가능하게 할지 프론트엔드 개발자로서 두렵지만(?) 기대된다.</p></article><a href="https://www.buymeacoffee.com/shiren" target="_blank" class="post__BuyMeACoffee-jduihc-0 fwhAwW"><img src="https://cdn.buymeacoffee.com/buttons/lato-orange.png" alt="Buy Me A Coffee"/></a><a href="https://ui.toast.com" target="_blank" class="post__AD-jduihc-3 bMNeLH">Why not?<br/><img src="/image/toastui.png" alt="TOAST UI"/></a><div class="recomendPost__Wrapper-sc-3jwe1s-0 bxZXPa"><h3>Recommend Post...</h3><div class="recomendPost__Container-sc-3jwe1s-1 dTTBOH"><div class="recomendPost__Item-sc-3jwe1s-3 ivcrIP"><div><div><a class="category__Category-sc-156lajf-0 lkGVVW" href="/javascript/1">javascript</a><a class="category__Category-sc-156lajf-0 lkGVVW" href="/translation/1">translation</a></div><a class="recomendPost__RecomendLink-sc-3jwe1s-5 ifREFF" href="/2018-10-24-reduce()를-이용해-순차적으로-프로미스를-해결하는-방법/"><h4 class="recomendPost__Title-sc-3jwe1s-2 jiiBBj">reduce() 를 이용해 순차적으로 프라미스를 해결하는 방법</h4><p class="recomendPost__Date-sc-3jwe1s-4 jjtNTt">24 October, 2018</p></a></div></div><div class="recomendPost__Item-sc-3jwe1s-3 ivcrIP"><div><div><a class="category__Category-sc-156lajf-0 lkGVVW" href="/frontend/1">frontend</a><a class="category__Category-sc-156lajf-0 lkGVVW" href="/tool/1">tool</a></div><a class="recomendPost__RecomendLink-sc-3jwe1s-5 ifREFF" href="/2019-05-22-크롬-네이티브-레이지-로딩/"><h4 class="recomendPost__Title-sc-3jwe1s-2 jiiBBj">크롬 네이티브 레이지 로딩</h4><p class="recomendPost__Date-sc-3jwe1s-4 jjtNTt">22 May, 2019</p></a></div></div><div class="recomendPost__Item-sc-3jwe1s-3 ivcrIP"><div><div><a class="category__Category-sc-156lajf-0 lkGVVW" href="/productivity/1">productivity</a><a class="category__Category-sc-156lajf-0 lkGVVW" href="/motivation/1">motivation</a><a class="category__Category-sc-156lajf-0 lkGVVW" href="/life/1">life</a></div><a class="recomendPost__RecomendLink-sc-3jwe1s-5 ifREFF" href="/2020-09-07/"><h4 class="recomendPost__Title-sc-3jwe1s-2 jiiBBj">하루 25분 실행하기: 하루를 대하는 14년차 개발자의 자세</h4><p class="recomendPost__Date-sc-3jwe1s-4 jjtNTt">07 September, 2020</p></a></div></div><div class="recomendPost__Item-sc-3jwe1s-3 ivcrIP"><div><div><a class="category__Category-sc-156lajf-0 lkGVVW" href="/motivation/1">motivation</a><a class="category__Category-sc-156lajf-0 lkGVVW" href="/life/1">life</a></div><a class="recomendPost__RecomendLink-sc-3jwe1s-5 ifREFF" href="/2020-10-05/"><h4 class="recomendPost__Title-sc-3jwe1s-2 jiiBBj">독서 습관을 만드는 구체적인 방법</h4><p class="recomendPost__Date-sc-3jwe1s-4 jjtNTt">05 October, 2020</p></a></div></div></div></div></div></div><footer class="footer__Wrapper-sc-1omp129-0 dKXtAy"><ul class="footer__FooterLinks-sc-1omp129-1 cfgaXG"><li><a href="mailto:shirenbeat@gmail.com" rel="noreferrer" target="_blank"><svg viewBox="0 0 512 512" aria-hidden="true" focusable="false" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="StyledIconBase-ea9ulj-0 duvCfz"><path fill="currentColor" d="M256 8C118.941 8 8 118.919 8 256c0 137.059 110.919 248 248 248 48.154 0 95.342-14.14 135.408-40.223 12.005-7.815 14.625-24.288 5.552-35.372l-10.177-12.433c-7.671-9.371-21.179-11.667-31.373-5.129C325.92 429.757 291.314 440 256 440c-101.458 0-184-82.542-184-184S154.542 72 256 72c100.139 0 184 57.619 184 160 0 38.786-21.093 79.742-58.17 83.693-17.349-.454-16.91-12.857-13.476-30.024l23.433-121.11C394.653 149.75 383.308 136 368.225 136h-44.981a13.518 13.518 0 00-13.432 11.993l-.01.092c-14.697-17.901-40.448-21.775-59.971-21.775-74.58 0-137.831 62.234-137.831 151.46 0 65.303 36.785 105.87 96 105.87 26.984 0 57.369-15.637 74.991-38.333 9.522 34.104 40.613 34.103 70.71 34.103C462.609 379.41 504 307.798 504 232 504 95.653 394.023 8 256 8zm-21.68 304.43c-22.249 0-36.07-15.623-36.07-40.771 0-44.993 30.779-72.729 58.63-72.729 22.292 0 35.601 15.241 35.601 40.77 0 45.061-33.875 72.73-58.161 72.73z"></path></svg></a></li><li><a href="//www.github.com/shiren" rel="noreferrer" target="_blank"><svg viewBox="0 0 496 512" aria-hidden="true" focusable="false" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="StyledIconBase-ea9ulj-0 duvCfz"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></li><li><a href="//www.instagram.com/shiren" rel="noreferrer" target="_blank"><svg viewBox="0 0 448 512" aria-hidden="true" focusable="false" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="StyledIconBase-ea9ulj-0 duvCfz"><path fill="currentColor" d="M224 202.66A53.34 53.34 0 10277.36 256 53.38 53.38 0 00224 202.66zm124.71-41a54 54 0 00-30.41-30.41c-21-8.29-71-6.43-94.3-6.43s-73.25-1.93-94.31 6.43a54 54 0 00-30.41 30.41c-8.28 21-6.43 71.05-6.43 94.33s-1.85 73.27 6.47 94.34a54 54 0 0030.41 30.41c21 8.29 71 6.43 94.31 6.43s73.24 1.93 94.3-6.43a54 54 0 0030.41-30.41c8.35-21 6.43-71.05 6.43-94.33s1.92-73.26-6.43-94.33zM224 338a82 82 0 1182-82 81.9 81.9 0 01-82 82zm85.38-148.3a19.14 19.14 0 1119.13-19.14 19.1 19.1 0 01-19.09 19.18zM400 32H48A48 48 0 000 80v352a48 48 0 0048 48h352a48 48 0 0048-48V80a48 48 0 00-48-48zm-17.12 290c-1.29 25.63-7.14 48.34-25.85 67s-41.4 24.63-67 25.85c-26.41 1.49-105.59 1.49-132 0-25.63-1.29-48.26-7.15-67-25.85s-24.63-41.42-25.85-67c-1.49-26.42-1.49-105.61 0-132 1.29-25.63 7.07-48.34 25.85-67s41.47-24.56 67-25.78c26.41-1.49 105.59-1.49 132 0 25.63 1.29 48.33 7.15 67 25.85s24.63 41.42 25.85 67.05c1.49 26.32 1.49 105.44 0 131.88z"></path></svg></a></li><li><a href="//www.facebook.com/shirenbeat" rel="noreferrer" target="_blank"><svg viewBox="0 0 512 512" aria-hidden="true" focusable="false" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="StyledIconBase-ea9ulj-0 duvCfz"><path fill="currentColor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"></path></svg></a></li><li><a href="//www.twitter.com/@shirenbeat" rel="noreferrer" target="_blank"><svg viewBox="0 0 512 512" aria-hidden="true" focusable="false" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="StyledIconBase-ea9ulj-0 duvCfz"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></a></li><li><a href="https://blog.shiren.dev/feed.xml" rel="noreferrer" target="_blank"><svg viewBox="0 0 448 512" aria-hidden="true" focusable="false" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="StyledIconBase-ea9ulj-0 duvCfz"><path fill="currentColor" d="M128.081 415.959c0 35.369-28.672 64.041-64.041 64.041S0 451.328 0 415.959s28.672-64.041 64.041-64.041 64.04 28.673 64.04 64.041zm175.66 47.25c-8.354-154.6-132.185-278.587-286.95-286.95C7.656 175.765 0 183.105 0 192.253v48.069c0 8.415 6.49 15.472 14.887 16.018 111.832 7.284 201.473 96.702 208.772 208.772.547 8.397 7.604 14.887 16.018 14.887h48.069c9.149.001 16.489-7.655 15.995-16.79zm144.249.288C439.596 229.677 251.465 40.445 16.503 32.01 7.473 31.686 0 38.981 0 48.016v48.068c0 8.625 6.835 15.645 15.453 15.999 191.179 7.839 344.627 161.316 352.465 352.465.353 8.618 7.373 15.453 15.999 15.453h48.068c9.034-.001 16.329-7.474 16.005-16.504z"></path></svg></a></li></ul><p>© <!-- -->Sungho Kim<!-- --> • <!-- -->2020</p></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-59192630-1', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2017-09-18-웹-기술로-구현하는-Adaptive-HTTP-Streaming/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-e31c70983b95bf93fc93.js"],"app":["/app-405ee9187730cca34a4a.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-a6b4ba2f2d2bbc34753f.js"],"component---src-templates-page-tsx":["/component---src-templates-page-tsx-119bd834de07dec4d612.js"],"component---src-templates-post-list-page-by-tag-tsx":["/component---src-templates-post-list-page-by-tag-tsx-070b118046c021e79d64.js"],"component---src-templates-post-list-page-tsx":["/component---src-templates-post-list-page-tsx-d468a3a0b8a20673c724.js"],"component---src-templates-post-tsx":["/component---src-templates-post-tsx-9588f4661b7f11e95e51.js"]};/*]]>*/</script><script src="/polyfill-e31c70983b95bf93fc93.js" nomodule=""></script><script src="/component---src-templates-post-tsx-9588f4661b7f11e95e51.js" async=""></script><script src="/d02ec7a3dda7d60b2b6f376de52e71913d9ba5e3-33b05cc05498f66ebadc.js" async=""></script><script src="/commons-8f7b6066959a66490891.js" async=""></script><script src="/app-405ee9187730cca34a4a.js" async=""></script><script src="/framework-de237a875aa45b276a9d.js" async=""></script><script src="/styles-55e82d6ff5158c00b714.js" async=""></script><script src="/webpack-runtime-a1ff71107fc67f26c43d.js" async=""></script></body></html>